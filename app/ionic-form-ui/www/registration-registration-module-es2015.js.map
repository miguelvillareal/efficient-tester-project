{"version":3,"sources":["./src/app/registration/registration.module.ts","./src/app/registration/registration.page.scss","./src/app/registration/registration.page.ts","./src/app/registration/registration.page.html","./src/app/registration/registration-routing.module.ts"],"names":[],"mappings":"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","file":"registration-registration-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RegistrationPageRoutingModule } from './registration-routing.module';\n\nimport { RegistrationPage } from './registration.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RegistrationPageRoutingModule\n  ],\n  declarations: [RegistrationPage]\n})\nexport class RegistrationPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZWdpc3RyYXRpb24ucGFnZS5zY3NzIn0= */\";","import { Component, OnInit } from '@angular/core';\n//import { Platform } from '@ionic/angular';\nimport { ApiDjangoService } from '../services/api-django.service';\nimport { Router } from '@angular/router';\nimport { AuthenticationService } from 'src/app/services/authentication.service';\n\n@Component({\n  selector: 'app-registration',\n  templateUrl: './registration.page.html',\n  styleUrls: ['./registration.page.scss'],\n})\nexport class RegistrationPage implements OnInit {\n  registerCredentials = { username: '', firstName: '', lastName: '', email: '', password: '', passwordbis: '' };\n\n  constructor(public apiService: ApiDjangoService,\n    public router: Router,\n    public authService: AuthenticationService) { }\n\n  ngOnInit() {\n  }\n  \n\n\n\n  register() {\n\n    if (this.registerCredentials.password != this.registerCredentials.passwordbis) {\n      this.apiService.showError(\"Sorry passwords doesn't match\");\n    }\n    else if(this.registerCredentials.password.length < 8 ){\n      this.apiService.showError(\"Password has to be 8 or more characters\");\n    }\n    else if (this.registerCredentials.username.length == 0 && this.registerCredentials.email.length == 0) {\n      this.apiService.showError(\"Please enter your email and username\");\n    }\n    else {\n      \n      if (this.apiService.networkConnected) {\n        this.apiService.showLoading();\n\n        // Check email\n        let queryPath = '?email=' + this.registerCredentials.email;\n        this.apiService.findUser(queryPath).subscribe((listUser) => {\n          this.apiService.stopLoading()\n          console.log(JSON.stringify(listUser))\n          if (listUser) {\n            let nbUserFound = listUser[\"count\"]\n            if (nbUserFound==0){\n              let userToCreate = {\n                \"email\": this.registerCredentials.email,\n                \"username\": this.registerCredentials.username,\n                \"firstName\": this.registerCredentials.firstName,\n                \"lastName\": this.registerCredentials.lastName,\n                \"password\": this.registerCredentials.password,\n                \"is_active\": true,\n                \"is_staff\": false\n              }\n  \n              this.apiService.createUser(userToCreate).subscribe((resultat) => {\n                if (resultat) {\n                  let queryPath = \"?email=\" + userToCreate.email;\n                  this.apiService.findUser(queryPath).subscribe((listUser) => { \n                    if(listUser){\n                      //console.log(listUser.password)\n                      //console.log(listUser.id)\n                      let queryPathTwo = resultat.id;\n                      let setUserInfo = {\n                        \"email\": resultat.email,\n                        \"username\": this.registerCredentials.username,\n                        \"firstName\": this.registerCredentials.firstName,\n                        \"lastName\": this.registerCredentials.lastName\n                      }\n                      this.apiService.infoUser(queryPathTwo, setUserInfo).subscribe((myUser) => { \n                        if(myUser){\n                          console.log(myUser);\n                        }\n                      });\n\n                      let labgroupToCreate = {\n                        \"name\": this.registerCredentials.username,\n                        \"group_id\": resultat.id\n                      }\n                \n                      this.apiService.createLabGroups(labgroupToCreate).subscribe((res) => {\n                      if (res) {\n                        console.log(res)\n                        let currentGroup = res.id;\n                        let userID = resultat.id;\n                        \n                        let groupMembershipToCreate = {\n                          \"user\": userID,\n                          \"group\": currentGroup, \n                          \"role\": 1\n                        }\n                        this.apiService.createLabGroupMembership(groupMembershipToCreate).subscribe((res) => {\n                          if (res) {\n                            console.log(res)\n                          }\n                          else {\n                            this.apiService.stopLoading();\n                            this.apiService.showError(\"An error occured while creating a LabGroupMembership\");\n                          }\n              \n              \n                        });   \n                      }\n                      else {\n                        this.apiService.stopLoading();\n                        this.apiService.showError(\"An error occured while creating a Lab Group\");\n                      }\n                      \n                    });\n\n                  }\n                  })\n                  //console.log(resultat)\n\n                }\n                else {\n                  this.apiService.stopLoading();\n                  this.apiService.showError(\"An error occured while registering\")\n                }\n              });\n\n              //Put info about user in their profile\n            }\n            else{\n              this.apiService.showError(\"An account already exists for this email, please login\");\n            }\n           \n          }\n          else {\n            \n            this.apiService.showError(\"An error occured while registering\")\n         \n          }\n        });\n\n      }\n    }\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Registration</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <form (ngSubmit)=\\\"register()\\\" #registerForm=\\\"ngForm\\\">\\n    \\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">Username</ion-label>\\n      <ion-input type=\\\"text\\\" name=\\\"username\\\"  [(ngModel)]=\\\"registerCredentials.username\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">First Name</ion-label>\\n      <ion-input type=\\\"text\\\" name=\\\"firstName\\\"  [(ngModel)]=\\\"registerCredentials.firstName\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">Last Name</ion-label>\\n      <ion-input type=\\\"text\\\" name=\\\"lastName\\\"  [(ngModel)]=\\\"registerCredentials.lastName\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">Email</ion-label>\\n      <ion-input type=\\\"email\\\" name=\\\"email\\\"  [(ngModel)]=\\\"registerCredentials.email\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">Password</ion-label>\\n      <ion-input type=\\\"password\\\" name=\\\"password\\\" [(ngModel)]=\\\"registerCredentials.password\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"full\\\">\\n      <ion-label position=\\\"floating\\\">Confirm Password</ion-label>\\n      <ion-input type=\\\"password\\\" name=\\\"passwordbis\\\" [(ngModel)]=\\\"registerCredentials.passwordbis\\\" required></ion-input>\\n    </ion-item>\\n\\n    <ion-row>\\n      <ion-col>\\n        <ion-button [routerLink]=\\\"['/home']\\\" type=\\\"submit\\\" color=\\\"danger\\\" expand=\\\"block\\\">Sign Up</ion-button>\\n      </ion-col>\\n    </ion-row>\\n  </form>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RegistrationPage } from './registration.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RegistrationPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RegistrationPageRoutingModule {}\n"],"sourceRoot":"webpack:///"}